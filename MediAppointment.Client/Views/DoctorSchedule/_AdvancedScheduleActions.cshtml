@model MediAppointment.Client.Models.DoctorSchedule.DoctorScheduleManagementViewModel

<!-- Bulk Schedule Management -->
<div class="card mt-3">
    <div class="card-header">
        <h6 class="mb-0"><i class="bi bi-gear"></i> Quản lý nâng cao</h6>
    </div>
    <div class="card-body">
        <div class="row">
            <!-- Bulk Register Form -->
            <div class="col-md-6">
                <form method="post" action="@Url.Action("BulkRegisterWeek")" id="bulkRegisterForm">
                    @Html.AntiForgeryToken()
                    <input type="hidden" name="roomId" value="@Model.RoomId" />
                    <input type="hidden" name="year" value="@Model.Year" />
                    <input type="hidden" name="week" value="@Model.Week" />
                    <input type="hidden" name="departmentId" value="@Model.DepartmentId" />
                    
                    <h6 class="text-success"><i class="bi bi-plus-circle"></i> Đăng ký hàng loạt</h6>
                    <div class="mb-3">
                        <label class="form-label">Chọn các ngày:</label>
                        @{
                            var jan1 = new DateTime(Model.Year, 1, 1);
                            var daysOffset = (int)DayOfWeek.Monday - (int)jan1.DayOfWeek;
                            var firstMonday = jan1.AddDays(daysOffset);
                            var startOfWeek = firstMonday.AddDays((Model.Week - 1) * 7);
                            var weekDates = Enumerable.Range(0, 7).Select(i => startOfWeek.AddDays(i)).ToList();
                        }
                        
                        @foreach (var date in weekDates)
                        {
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" name="selectedDates" 
                                       value="@date.ToString("yyyy-MM-dd")" id="date_@date.ToString("yyyyMMdd")">
                                <label class="form-check-label" for="date_@date.ToString("yyyyMMdd")">
                                    @date.ToString("ddd, dd/MM/yyyy", new System.Globalization.CultureInfo("vi-VN"))
                                </label>
                            </div>
                        }
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label">Chọn ca làm việc:</label>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" name="periods" value="morning" id="morning">
                            <label class="form-check-label" for="morning">Ca sáng (07:00 - 11:00)</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" name="periods" value="afternoon" id="afternoon">
                            <label class="form-check-label" for="afternoon">Ca chiều (13:00 - 17:00)</label>
                        </div>
                    </div>
                    
                    <button type="submit" class="btn btn-success btn-sm">
                        <i class="bi bi-check-all"></i> Đăng ký tất cả
                    </button>
                </form>
            </div>
            
            <!-- Bulk Cancel Form -->
            <div class="col-md-6">
                <form method="post" action="@Url.Action("BulkCancelWeek")" id="bulkCancelForm">
                    @Html.AntiForgeryToken()
                    <input type="hidden" name="roomId" value="@Model.RoomId" />
                    <input type="hidden" name="year" value="@Model.Year" />
                    <input type="hidden" name="week" value="@Model.Week" />
                    <input type="hidden" name="departmentId" value="@Model.DepartmentId" />
                    
                    <h6 class="text-danger"><i class="bi bi-trash"></i> Hủy hàng loạt</h6>
                    <div class="mb-3">
                        <label class="form-label">Hủy tất cả ca đã đăng ký trong tuần này?</label>
                        <p class="text-muted small">Thao tác này sẽ hủy tất cả ca làm việc đã đăng ký trong tuần @Model.Week.</p>
                    </div>
                    
                    <button type="submit" class="btn btn-danger btn-sm"
                            onclick="return confirm('Bạn có chắc chắn muốn hủy TẤT CẢ ca làm việc trong tuần này không? Thao tác này không thể hoàn tác.')">
                        <i class="bi bi-trash-fill"></i> Hủy tất cả ca trong tuần
                    </button>
                </form>
            </div>
        </div>
        
        <!-- Quick Actions -->
        <div class="row mt-3">
            <div class="col-12">
                <div class="border-top pt-3">
                    <h6><i class="bi bi-lightning"></i> Thao tác nhanh</h6>
                    <div class="d-flex gap-2 flex-wrap">
                        <form method="post" action="@Url.Action("RegisterAllMorning")" class="d-inline">
                            @Html.AntiForgeryToken()
                            <input type="hidden" name="roomId" value="@Model.RoomId" />
                            <input type="hidden" name="year" value="@Model.Year" />
                            <input type="hidden" name="week" value="@Model.Week" />
                            <input type="hidden" name="departmentId" value="@Model.DepartmentId" />
                            <button type="submit" class="btn btn-outline-success btn-sm">
                                <i class="bi bi-sunrise"></i> Đăng ký tất cả ca sáng
                            </button>
                        </form>
                        
                        <form method="post" action="@Url.Action("RegisterAllAfternoon")" class="d-inline">
                            @Html.AntiForgeryToken()
                            <input type="hidden" name="roomId" value="@Model.RoomId" />
                            <input type="hidden" name="year" value="@Model.Year" />
                            <input type="hidden" name="week" value="@Model.Week" />
                            <input type="hidden" name="departmentId" value="@Model.DepartmentId" />
                            <button type="submit" class="btn btn-outline-info btn-sm">
                                <i class="bi bi-sunset"></i> Đăng ký tất cả ca chiều
                            </button>
                        </form>
                        
                        <form method="post" action="@Url.Action("RegisterWorkdays")" class="d-inline">
                            @Html.AntiForgeryToken()
                            <input type="hidden" name="roomId" value="@Model.RoomId" />
                            <input type="hidden" name="year" value="@Model.Year" />
                            <input type="hidden" name="week" value="@Model.Week" />
                            <input type="hidden" name="departmentId" value="@Model.DepartmentId" />
                            <button type="submit" class="btn btn-outline-primary btn-sm">
                                <i class="bi bi-calendar-check"></i> Đăng ký ngày làm việc (T2-T6)
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.form-check {
    margin-bottom: 0.5rem;
}

.form-check-label {
    cursor: pointer;
}

.btn-sm {
    white-space: nowrap;
}

@@media (max-width: 768px) {
    .d-flex.gap-2.flex-wrap .btn {
        margin-bottom: 0.5rem;
        width: 100%;
    }
}
</style>
