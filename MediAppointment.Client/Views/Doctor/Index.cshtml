@model List<MediAppointment.Client.Models.Doctor.DoctorViewModel>
@{
    ViewData["Title"] = "Danh sách bác sĩ";
}

<style>
    .doctor-page-container {
        padding: 2rem;
        max-width: 1400px;
        margin: 0 auto;
    }
    
    .page-header-doctor {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 2.5rem;
        border-radius: 20px;
        margin-bottom: 2rem;
        box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
        position: relative;
        overflow: hidden;
    }
    
    .page-header-doctor::before {
        content: '';
        position: absolute;
        top: -50%;
        right: -20%;
        width: 200px;
        height: 200px;
        background: rgba(255,255,255,0.1);
        border-radius: 50%;
    }
    
    .page-header-doctor::after {
        content: '';
        position: absolute;
        bottom: -30%;
        left: -10%;
        width: 150px;
        height: 150px;
        background: rgba(255,255,255,0.08);
        border-radius: 50%;
    }
    
    .search-filter-section {
        background: white;
        padding: 2rem;
        border-radius: 15px;
        box-shadow: 0 5px 20px rgba(0,0,0,0.08);
        margin-bottom: 2rem;
        border-left: 5px solid #667eea;
    }
    
    .search-input-custom {
        border-radius: 25px;
        border: 2px solid #e9ecef;
        padding: 0.75rem 1.5rem;
        transition: all 0.3s ease;
        box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    }
    
    .search-input-custom:focus {
        border-color: #667eea;
        box-shadow: 0 0 0 0.2rem rgba(102, 126, 234, 0.25);
        transform: translateY(-2px);
    }
    
    .filter-select-custom {
        border-radius: 15px;
        border: 2px solid #e9ecef;
        padding: 0.75rem 1rem;
        transition: all 0.3s ease;
        box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    }
    
    .filter-select-custom:focus {
        border-color: #667eea;
        box-shadow: 0 0 0 0.2rem rgba(102, 126, 234, 0.25);
    }
    
    .doctor-card-custom {
        border: none;
        border-radius: 20px;
        transition: all 0.4s ease;
        background: linear-gradient(135deg, #ffffff 0%, #f8f9ff 100%);
        box-shadow: 0 5px 20px rgba(0,0,0,0.08);
        overflow: hidden;
        position: relative;
        height: 100%;
    }
    
    .doctor-card-custom:hover {
        transform: translateY(-10px) scale(1.02);
        box-shadow: 0 20px 40px rgba(0,0,0,0.15);
    }
    
    .doctor-card-custom::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }
    
    .doctor-avatar-custom {
        width: 100px;
        height: 100px;
        border-radius: 50%;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 0 auto 1rem;
        border: 4px solid white;
        box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        transition: all 0.3s ease;
    }
    
    .doctor-card-custom:hover .doctor-avatar-custom {
        transform: scale(1.1);
        box-shadow: 0 12px 35px rgba(102, 126, 234, 0.4);
    }
    
    .doctor-name {
        color: #2c3e50;
        font-weight: 700;
        font-size: 1.25rem;
        margin-bottom: 0.5rem;
    }
    
    .gender-info {
        color: #6c757d;
        font-size: 0.95rem;
        margin-bottom: 1rem;
    }
    
    .department-badge {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border: none;
        border-radius: 15px;
        padding: 0.4rem 0.8rem;
        font-size: 0.8rem;
        font-weight: 500;
        margin: 0.2rem;
        transition: all 0.3s ease;
    }
    
    .department-badge:hover {
        transform: scale(1.1);
        box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
    }
    
    .contact-info {
        background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        border-radius: 12px;
        padding: 1rem;
        margin-bottom: 1rem;
        border-left: 3px solid #667eea;
    }
    
    .contact-info small {
        color: #495057;
        line-height: 1.6;
    }
    
    .schedule-status {
        background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
        color: white;
        border-radius: 20px;
        padding: 0.5rem 1rem;
        font-size: 0.85rem;
        font-weight: 500;
        display: inline-block;
    }
    
    .card-footer-custom {
        background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
        border-top: 1px solid #e9ecef;
        padding: 1.5rem;
    }
    
    .btn-custom {
        border-radius: 20px;
        padding: 0.6rem 1.5rem;
        font-weight: 600;
        transition: all 0.3s ease;
        border: 2px solid transparent;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        justify-content: center;
    }
    
    .btn-custom:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 20px rgba(0,0,0,0.15);
    }
    
    .btn-outline-custom {
        background: transparent;
        color: #667eea;
        border-color: #667eea;
    }
    
    .btn-outline-custom:hover {
        background: #667eea;
        color: white;
    }
    
    .btn-primary-custom {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border: none;
    }
    
    .btn-primary-custom:hover {
        background: linear-gradient(135deg, #5a6fd8 0%, #6a4190 100%);
        color: white;
    }
    
    .empty-state-custom {
        background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        border-radius: 20px;
        padding: 4rem 2rem;
        text-align: center;
        box-shadow: 0 5px 20px rgba(0,0,0,0.1);
    }
    
    .stats-section {
        background: white;
        border-radius: 15px;
        padding: 1.5rem;
        margin-bottom: 2rem;
        box-shadow: 0 5px 15px rgba(0,0,0,0.05);
    }
    
    .stat-item {
        text-align: center;
        padding: 1rem;
    }
    
    .stat-number {
        font-size: 2rem;
        font-weight: 700;
        color: #667eea;
        display: block;
    }
    
    .stat-label {
        color: #6c757d;
        font-size: 0.9rem;
        margin-top: 0.5rem;
    }
    
    @@media (max-width: 768px) {
        .doctor-page-container {
            padding: 1rem;
        }
        
        .page-header-doctor {
            padding: 2rem 1.5rem;
        }
        
        .search-filter-section {
            padding: 1.5rem;
        }
        
        .search-input-custom {
            width: 100% !important;
            margin-bottom: 1rem;
        }
        
        .filter-select-custom {
            width: 100% !important;
        }
    }
</style>

<div class="doctor-page-container">
    <div class="page-header-doctor">
        <div class="position-relative">
            <h1 class="mb-2">
                <i class="fas fa-user-md me-3"></i>
                Đội ngũ bác sĩ chuyên nghiệp
            </h1>
            <p class="mb-0 opacity-75 lead">
                Gặp gỡ các bác sĩ giàu kinh nghiệm và tận tâm với bệnh nhân
            </p>
        </div>
    </div>

    @if (Model.Any())
    {
        <!-- Search and Filter Section -->
        <div class="search-filter-section">
            <div class="row align-items-center">
                <div class="col-lg-8 mb-3 mb-lg-0">
                    <div class="d-flex flex-column flex-md-row gap-3">
                        <div class="flex-fill">
                            <label class="form-label fw-bold text-muted mb-2">
                                <i class="fas fa-search me-1"></i>Tìm kiếm bác sĩ
                            </label>
                            <input type="text" 
                                   class="form-control search-input-custom" 
                                   placeholder="Nhập tên bác sĩ..." 
                                   id="searchInput">
                        </div>
                        <div style="min-width: 200px;">
                            <label class="form-label fw-bold text-muted mb-2">
                                <i class="fas fa-filter me-1"></i>Lọc theo khoa
                            </label>
                            <select class="form-select filter-select-custom" id="departmentFilter">
                                <option value="">Tất cả chuyên khoa</option>
                                <option value="Tim mạch">Tim mạch</option>
                                <option value="Nội khoa">Nội khoa</option>
                                <option value="Ngoại khoa">Ngoại khoa</option>
                                <option value="Sản phụ khoa">Sản phụ khoa</option>
                                <option value="Nhi khoa">Nhi khoa</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="col-lg-4 text-lg-end">
                    <div class="text-muted">
                        <i class="fas fa-info-circle me-2"></i>
                        <span id="resultCount">@Model.Count</span> bác sĩ được tìm thấy
                    </div>
                </div>
            </div>
        </div>

        <!-- Doctors Grid -->
        <div class="row" id="doctorList">
            @foreach (var doctor in Model)
            {
                <div class="col-xl-4 col-lg-6 col-md-6 mb-4 doctor-card" 
                     data-name="@doctor.FullName.ToLower()" 
                     data-departments="@string.Join(",", doctor.Departments).ToLower()">
                    <div class="card doctor-card-custom h-100">
                        <div class="card-body text-center p-4">
                            <div class="doctor-avatar-custom">
                                <i class="fas fa-user-md text-white" style="font-size: 2.5rem;"></i>
                            </div>
                            
                            <h5 class="doctor-name">@doctor.FullName</h5>
                            
                            <div class="gender-info">
                                <i class="fas fa-venus-mars me-2"></i>@doctor.GenderDisplay
                            </div>
                            
                            @if (doctor.Departments.Any())
                            {
                                <div class="mb-3">
                                    @foreach (var dept in doctor.Departments)
                                    {
                                        <span class="badge department-badge">
                                            <i class="fas fa-stethoscope me-1"></i>@dept
                                        </span>
                                    }
                                </div>
                            }

                            <div class="contact-info">
                                <div class="mb-2">
                                    <i class="fas fa-envelope text-primary me-2"></i>
                                    <small>@doctor.Email</small>
                                </div>
                                <div>
                                    <i class="fas fa-phone text-primary me-2"></i>
                                    <small>@doctor.PhoneNumber</small>
                                </div>
                            </div>

                            @if (doctor.Schedules.Any())
                            {
                                <div class="mb-3">
                                    <span class="schedule-status">
                                        <i class="fas fa-calendar-check me-2"></i>
                                        Có lịch trống tuần này
                                    </span>
                                </div>
                            }
                        </div>
                        
                        <div class="card-footer-custom">
                            <div class="d-flex justify-content-center gap-2">
                                <form asp-action="Profile" method="post" style="display:inline;">
                                    <input type="hidden" name="doctorId" value="@doctor.Id" />
                                    <button type="submit" class="btn btn-outline-custom btn-custom">
                                        <i class="fas fa-eye me-2"></i>Xem hồ sơ
                                    </button>
                                </form>
                                <a asp-controller="Appointment" asp-action="Create" asp-route-doctorId="@doctor.Id" 
                                   class="btn btn-primary-custom btn-custom">
                                    <i class="fas fa-calendar-plus me-2"></i>Đặt lịch khám
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            }
        </div>

        <!-- No results message -->
        <div id="noResults" class="text-center py-5" style="display: none;">
            <div class="empty-state-custom">
                <i class="fas fa-search text-muted mb-4" style="font-size: 4rem; opacity: 0.7;"></i>
                <h4 class="text-muted mb-3">Không tìm thấy bác sĩ phù hợp</h4>
                <p class="text-muted">Vui lòng thử với từ khóa khác hoặc thay đổi bộ lọc</p>
                <button onclick="clearFilters()" class="btn btn-primary-custom btn-custom mt-3">
                    <i class="fas fa-refresh me-2"></i>Xóa bộ lọc
                </button>
            </div>
        </div>
    }
    else
    {
        <div class="empty-state-custom">
            <i class="fas fa-user-md text-primary mb-4" style="font-size: 5rem; opacity: 0.7;"></i>
            <h3 class="text-primary mb-3">Đang cập nhật thông tin bác sĩ</h3>
            <p class="text-muted mb-4 lead">
                Chúng tôi đang hoàn thiện danh sách đội ngũ bác sĩ chuyên nghiệp. 
                Vui lòng quay lại sau ít phút.
            </p>
            <a href="/" class="btn btn-primary-custom btn-custom">
                <i class="fas fa-home me-2"></i>Về trang chủ
            </a>
        </div>
    }
</div>

@section Scripts {
    <script>
        $(document).ready(function() {
            function updateResultCount() {
                const visibleCards = $('.doctor-card:visible').length;
                $('#resultCount').text(visibleCards);
            }
            
            function filterDoctors() {
                const searchTerm = $('#searchInput').val().toLowerCase();
                const selectedDepartment = $('#departmentFilter').val().toLowerCase();
                let visibleCount = 0;

                $('.doctor-card').each(function() {
                    const doctorName = $(this).data('name');
                    const doctorDepartments = $(this).data('departments');
                    
                    const matchesSearch = !searchTerm || doctorName.includes(searchTerm);
                    const matchesDepartment = !selectedDepartment || doctorDepartments.includes(selectedDepartment);
                    
                    if (matchesSearch && matchesDepartment) {
                        $(this).show();
                        visibleCount++;
                    } else {
                        $(this).hide();
                    }
                });

                if (visibleCount === 0) {
                    $('#noResults').show();
                } else {
                    $('#noResults').hide();
                }
                
                updateResultCount();
            }

            // Clear filters function
            window.clearFilters = function() {
                $('#searchInput').val('');
                $('#departmentFilter').val('');
                filterDoctors();
            };

            // Event handlers
            $('#searchInput').on('input', filterDoctors);
            $('#departmentFilter').on('change', filterDoctors);
            
            // Add animation on page load
            $('.doctor-card-custom').each(function(index) {
                $(this).delay(index * 100).fadeIn(500);
            });
            
            // Initial count
            updateResultCount();
        });
    </script>
}
